import{r as O,j as h,C as Fe}from"./index-D6IrrwlD.js";function Je(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var re={exports:{}},be;function Ve(){return be||(be=1,(function(a){var n=(function(o){var c=Object.prototype,i=c.hasOwnProperty,u=Object.defineProperty||function(r,e,t){r[e]=t.value},p,m=typeof Symbol=="function"?Symbol:{},k=m.iterator||"@@iterator",A=m.asyncIterator||"@@asyncIterator",S=m.toStringTag||"@@toStringTag";function w(r,e,t){return Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}),r[e]}try{w({},"")}catch{w=function(e,t,l){return e[t]=l}}function E(r,e,t,l){var s=e&&e.prototype instanceof T?e:T,v=Object.create(s.prototype),I=new U(l||[]);return u(v,"_invoke",{value:Q(r,t,I)}),v}o.wrap=E;function R(r,e,t){try{return{type:"normal",arg:r.call(e,t)}}catch(l){return{type:"throw",arg:l}}}var j="suspendedStart",y="suspendedYield",C="executing",x="completed",N={};function T(){}function P(){}function W(){}var K={};w(K,k,function(){return this});var g=Object.getPrototypeOf,L=g&&g(g(J([])));L&&L!==c&&i.call(L,k)&&(K=L);var M=W.prototype=T.prototype=Object.create(K);P.prototype=W,u(M,"constructor",{value:W,configurable:!0}),u(W,"constructor",{value:P,configurable:!0}),P.displayName=w(W,S,"GeneratorFunction");function _(r){["next","throw","return"].forEach(function(e){w(r,e,function(t){return this._invoke(e,t)})})}o.isGeneratorFunction=function(r){var e=typeof r=="function"&&r.constructor;return e?e===P||(e.displayName||e.name)==="GeneratorFunction":!1},o.mark=function(r){return Object.setPrototypeOf?Object.setPrototypeOf(r,W):(r.__proto__=W,w(r,S,"GeneratorFunction")),r.prototype=Object.create(M),r},o.awrap=function(r){return{__await:r}};function Y(r,e){function t(v,I,q,B){var G=R(r[v],r,I);if(G.type==="throw")B(G.arg);else{var d=G.arg,f=d.value;return f&&typeof f=="object"&&i.call(f,"__await")?e.resolve(f.__await).then(function(b){t("next",b,q,B)},function(b){t("throw",b,q,B)}):e.resolve(f).then(function(b){d.value=b,q(d)},function(b){return t("throw",b,q,B)})}}var l;function s(v,I){function q(){return new e(function(B,G){t(v,I,B,G)})}return l=l?l.then(q,q):q()}u(this,"_invoke",{value:s})}_(Y.prototype),w(Y.prototype,A,function(){return this}),o.AsyncIterator=Y,o.async=function(r,e,t,l,s){s===void 0&&(s=Promise);var v=new Y(E(r,e,t,l),s);return o.isGeneratorFunction(e)?v:v.next().then(function(I){return I.done?I.value:v.next()})};function Q(r,e,t){var l=j;return function(v,I){if(l===C)throw new Error("Generator is already running");if(l===x){if(v==="throw")throw I;return Z()}for(t.method=v,t.arg=I;;){var q=t.delegate;if(q){var B=z(q,t);if(B){if(B===N)continue;return B}}if(t.method==="next")t.sent=t._sent=t.arg;else if(t.method==="throw"){if(l===j)throw l=x,t.arg;t.dispatchException(t.arg)}else t.method==="return"&&t.abrupt("return",t.arg);l=C;var G=R(r,e,t);if(G.type==="normal"){if(l=t.done?x:y,G.arg===N)continue;return{value:G.arg,done:t.done}}else G.type==="throw"&&(l=x,t.method="throw",t.arg=G.arg)}}}function z(r,e){var t=e.method,l=r.iterator[t];if(l===p)return e.delegate=null,t==="throw"&&r.iterator.return&&(e.method="return",e.arg=p,z(r,e),e.method==="throw")||t!=="return"&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+t+"' method")),N;var s=R(l,r.iterator,e.arg);if(s.type==="throw")return e.method="throw",e.arg=s.arg,e.delegate=null,N;var v=s.arg;if(!v)return e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,N;if(v.done)e[r.resultName]=v.value,e.next=r.nextLoc,e.method!=="return"&&(e.method="next",e.arg=p);else return v;return e.delegate=null,N}_(M),w(M,S,"Generator"),w(M,k,function(){return this}),w(M,"toString",function(){return"[object Generator]"});function D(r){var e={tryLoc:r[0]};1 in r&&(e.catchLoc=r[1]),2 in r&&(e.finallyLoc=r[2],e.afterLoc=r[3]),this.tryEntries.push(e)}function V(r){var e=r.completion||{};e.type="normal",delete e.arg,r.completion=e}function U(r){this.tryEntries=[{tryLoc:"root"}],r.forEach(D,this),this.reset(!0)}o.keys=function(r){var e=Object(r),t=[];for(var l in e)t.push(l);return t.reverse(),function s(){for(;t.length;){var v=t.pop();if(v in e)return s.value=v,s.done=!1,s}return s.done=!0,s}};function J(r){if(r){var e=r[k];if(e)return e.call(r);if(typeof r.next=="function")return r;if(!isNaN(r.length)){var t=-1,l=function s(){for(;++t<r.length;)if(i.call(r,t))return s.value=r[t],s.done=!1,s;return s.value=p,s.done=!0,s};return l.next=l}}return{next:Z}}o.values=J;function Z(){return{value:p,done:!0}}return U.prototype={constructor:U,reset:function(r){if(this.prev=0,this.next=0,this.sent=this._sent=p,this.done=!1,this.delegate=null,this.method="next",this.arg=p,this.tryEntries.forEach(V),!r)for(var e in this)e.charAt(0)==="t"&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=p)},stop:function(){this.done=!0;var r=this.tryEntries[0],e=r.completion;if(e.type==="throw")throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var e=this;function t(B,G){return v.type="throw",v.arg=r,e.next=B,G&&(e.method="next",e.arg=p),!!G}for(var l=this.tryEntries.length-1;l>=0;--l){var s=this.tryEntries[l],v=s.completion;if(s.tryLoc==="root")return t("end");if(s.tryLoc<=this.prev){var I=i.call(s,"catchLoc"),q=i.call(s,"finallyLoc");if(I&&q){if(this.prev<s.catchLoc)return t(s.catchLoc,!0);if(this.prev<s.finallyLoc)return t(s.finallyLoc)}else if(I){if(this.prev<s.catchLoc)return t(s.catchLoc,!0)}else if(q){if(this.prev<s.finallyLoc)return t(s.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(r,e){for(var t=this.tryEntries.length-1;t>=0;--t){var l=this.tryEntries[t];if(l.tryLoc<=this.prev&&i.call(l,"finallyLoc")&&this.prev<l.finallyLoc){var s=l;break}}s&&(r==="break"||r==="continue")&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var v=s?s.completion:{};return v.type=r,v.arg=e,s?(this.method="next",this.next=s.finallyLoc,N):this.complete(v)},complete:function(r,e){if(r.type==="throw")throw r.arg;return r.type==="break"||r.type==="continue"?this.next=r.arg:r.type==="return"?(this.rval=this.arg=r.arg,this.method="return",this.next="end"):r.type==="normal"&&e&&(this.next=e),N},finish:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===r)return this.complete(t.completion,t.afterLoc),V(t),N}},catch:function(r){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===r){var l=t.completion;if(l.type==="throw"){var s=l.arg;V(t)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(r,e,t){return this.delegate={iterator:J(r),resultName:e,nextLoc:t},this.method==="next"&&(this.arg=p),N}},o})(a.exports);try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})(re)),re.exports}var te,Ee;function Se(){return Ee||(Ee=1,te=(a,n)=>`${a}-${n}-${Math.random().toString(16).slice(3,8)}`),te}var ne,ke;function $e(){if(ke)return ne;ke=1;const a=Se();let n=0;return ne=({id:o,action:c,payload:i={}})=>{let u=o;return typeof u>"u"&&(u=a("Job",n),n+=1),{id:u,action:c,payload:i}},ne}var X={},Ne;function Le(){if(Ne)return X;Ne=1;let a=!1;return X.logging=a,X.setLogging=n=>{a=n},X.log=(...n)=>a?console.log.apply(this,n):null,X}var oe,Oe;function Ze(){if(Oe)return oe;Oe=1;const a=$e(),{log:n}=Le(),o=Se();let c=0;return oe=()=>{const i=o("Scheduler",c),u={},p={};let m=[];c+=1;const k=()=>m.length,A=()=>Object.keys(u).length,S=()=>{if(m.length!==0){const y=Object.keys(u);for(let C=0;C<y.length;C+=1)if(typeof p[y[C]]>"u"){m[0](u[y[C]]);break}}},w=(y,C)=>new Promise((x,N)=>{const T=a({action:y,payload:C});m.push(async P=>{m.shift(),p[P.id]=T;try{x(await P[y].apply(this,[...C,T.id]))}catch(W){N(W)}finally{delete p[P.id],S()}}),n(`[${i}]: Add ${T.id} to JobQueue`),n(`[${i}]: JobQueue length=${m.length}`),S()});return{addWorker:y=>(u[y.id]=y,n(`[${i}]: Add ${y.id}`),n(`[${i}]: Number of workers=${A()}`),S(),y.id),addJob:async(y,...C)=>{if(A()===0)throw Error(`[${i}]: You need to have at least one worker before adding jobs`);return w(y,C)},terminate:async()=>{Object.keys(u).forEach(async y=>{await u[y].terminate()}),m=[]},getQueueLen:k,getNumWorkers:A}},oe}function Qe(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ae,Ce;function Xe(){return Ce||(Ce=1,ae=a=>{const n={};return typeof WorkerGlobalScope<"u"?n.type="webworker":typeof document=="object"?n.type="browser":typeof process=="object"&&typeof Qe=="function"&&(n.type="node"),typeof a>"u"?n:n[a]}),ae}var ie,Te;function er(){if(Te)return ie;Te=1;const n=Xe()("type")==="browser"?o=>new URL(o,window.location.href).href:o=>o;return ie=o=>{const c={...o};return["corePath","workerPath","langPath"].forEach(i=>{o[i]&&(c[i]=n(c[i]))}),c},ie}var se,Ae;function Ye(){return Ae||(Ae=1,se={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),se}const rr="7.0.0",tr={version:rr};var ce,je;function nr(){return je||(je=1,ce={workerBlobURL:!0,logger:()=>{}}),ce}var ue,_e;function or(){if(_e)return ue;_e=1;const a=tr.version;return ue={...nr(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${a}/dist/worker.min.js`},ue}var le,Pe;function ar(){return Pe||(Pe=1,le=({workerPath:a,workerBlobURL:n})=>{let o;if(Blob&&URL&&n){const c=new Blob([`importScripts("${a}");`],{type:"application/javascript"});o=new Worker(URL.createObjectURL(c))}else o=new Worker(a);return o}),le}var de,Me;function ir(){return Me||(Me=1,de=a=>{a.terminate()}),de}var fe,Ie;function sr(){return Ie||(Ie=1,fe=(a,n)=>{a.onmessage=({data:o})=>{n(o)}}),fe}var he,qe;function cr(){return qe||(qe=1,he=async(a,n)=>{a.postMessage(n)}),he}var pe,Ge;function ur(){if(Ge)return pe;Ge=1;const a=o=>new Promise((c,i)=>{const u=new FileReader;u.onload=()=>{c(u.result)},u.onerror=({target:{error:{code:p}}})=>{i(Error(`File could not be read! Code=${p}`))},u.readAsArrayBuffer(o)}),n=async o=>{let c=o;if(typeof o>"u")return"undefined";if(typeof o=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(o)?c=atob(o.split(",")[1]).split("").map(i=>i.charCodeAt(0)):c=await(await fetch(o)).arrayBuffer();else if(typeof HTMLElement<"u"&&o instanceof HTMLElement)o.tagName==="IMG"&&(c=await n(o.src)),o.tagName==="VIDEO"&&(c=await n(o.poster)),o.tagName==="CANVAS"&&await new Promise(i=>{o.toBlob(async u=>{c=await a(u),i()})});else if(typeof OffscreenCanvas<"u"&&o instanceof OffscreenCanvas){const i=await o.convertToBlob();c=await a(i)}else(o instanceof File||o instanceof Blob)&&(c=await a(o));return new Uint8Array(c)};return pe=n,pe}var ge,xe;function lr(){if(xe)return ge;xe=1;const a=or(),n=ar(),o=ir(),c=sr(),i=cr(),u=ur();return ge={defaultOptions:a,spawnWorker:n,terminateWorker:o,onMessage:c,send:i,loadImage:u},ge}var ve,We;function He(){if(We)return ve;We=1;const a=er(),n=$e(),{log:o}=Le(),c=Se(),i=Ye(),{defaultOptions:u,spawnWorker:p,terminateWorker:m,onMessage:k,loadImage:A,send:S}=lr();let w=0;return ve=async(E="eng",R=i.LSTM_ONLY,j={},y={})=>{const C=c("Worker",w),{logger:x,errorHandler:N,...T}=a({...u,...j}),P={},W=typeof E=="string"?E.split("+"):E;let K=R,g=y;const L=[i.DEFAULT,i.LSTM_ONLY].includes(R)&&!T.legacyCore;let M,_;const Y=new Promise((d,f)=>{_=d,M=f}),Q=d=>{M(d.message)};let z=p(T);z.onerror=Q,w+=1;const D=({id:d,action:f,payload:b})=>new Promise((F,$)=>{o(`[${C}]: Start ${d}, action=${f}`);const H=`${f}-${d}`;P[H]={resolve:F,reject:$},S(z,{workerId:C,jobId:d,action:f,payload:b})}),V=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),U=d=>D(n({id:d,action:"load",payload:{options:{lstmOnly:L,corePath:T.corePath,logging:T.logging}}})),J=(d,f,b)=>D(n({id:b,action:"FS",payload:{method:"writeFile",args:[d,f]}})),Z=(d,f)=>D(n({id:f,action:"FS",payload:{method:"readFile",args:[d,{encoding:"utf8"}]}})),r=(d,f)=>D(n({id:f,action:"FS",payload:{method:"unlink",args:[d]}})),e=(d,f,b)=>D(n({id:b,action:"FS",payload:{method:d,args:f}})),t=(d,f)=>D(n({id:f,action:"loadLanguage",payload:{langs:d,options:{langPath:T.langPath,dataPath:T.dataPath,cachePath:T.cachePath,cacheMethod:T.cacheMethod,gzip:T.gzip,lstmOnly:[i.DEFAULT,i.LSTM_ONLY].includes(K)&&!T.legacyLang}}})),l=(d,f,b,F)=>D(n({id:F,action:"initialize",payload:{langs:d,oem:f,config:b}})),s=(d="eng",f,b,F)=>{if(L&&[i.TESSERACT_ONLY,i.TESSERACT_LSTM_COMBINED].includes(f))throw Error("Legacy model requested but code missing.");const $=f||K;K=$;const H=b||g;g=H;const ee=(typeof d=="string"?d.split("+"):d).filter(Ke=>!W.includes(Ke));return W.push(...ee),ee.length>0?t(ee,F).then(()=>l(d,$,H,F)):l(d,$,H,F)},v=(d={},f)=>D(n({id:f,action:"setParameters",payload:{params:d}})),I=async(d,f={},b={text:!0},F)=>D(n({id:F,action:"recognize",payload:{image:await A(d),options:f,output:b}})),q=async(d,f)=>{if(L)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return D(n({id:f,action:"detect",payload:{image:await A(d)}}))},B=async()=>(z!==null&&(m(z),z=null),Promise.resolve());k(z,({workerId:d,jobId:f,status:b,action:F,data:$})=>{const H=`${F}-${f}`;if(b==="resolve")o(`[${d}]: Complete ${f}`),P[H].resolve({jobId:f,data:$}),delete P[H];else if(b==="reject")if(P[H].reject($),delete P[H],F==="load"&&M($),N)N($);else throw Error($);else b==="progress"&&x({...$,userJobId:f})});const G={id:C,worker:z,load:V,writeText:J,readText:Z,removeFile:r,FS:e,reinitialize:s,setParameters:v,recognize:I,detect:q,terminate:B};return U().then(()=>t(E)).then(()=>l(E,R,y)).then(()=>_(G)).catch(()=>{}),Y},ve}var me,De;function dr(){if(De)return me;De=1;const a=He();return me={recognize:async(c,i,u)=>{const p=await a(i,1,u);return p.recognize(c).finally(async()=>{await p.terminate()})},detect:async(c,i)=>{const u=await a("osd",0,i);return u.detect(c).finally(async()=>{await u.terminate()})}},me}var ye,Ue;function fr(){return Ue||(Ue=1,ye={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),ye}var we,Be;function hr(){return Be||(Be=1,we={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),we}var Re,ze;function pr(){if(ze)return Re;ze=1,Ve();const a=Ze(),n=He(),o=dr(),c=fr(),i=Ye(),u=hr(),{setLogging:p}=Le();return Re={languages:c,OEM:i,PSM:u,createScheduler:a,createWorker:n,setLogging:p,...o},Re}var gr=pr();const vr=Je(gr);function mr(){const[a,n]=O.useState(!1),[o,c]=O.useState(null),[i,u]=O.useState(0),p=O.useRef(null),m=O.useCallback(async()=>{if(!p.current){const A=await vr.createWorker("eng",void 0,{logger:S=>{S.status==="recognizing text"&&u(Math.round(S.progress*100))}});await A.setParameters({tessedit_char_whitelist:"0123456789"}),p.current=A}return p.current},[]);return{recognize:O.useCallback(async(A,S)=>{n(!0),c(null),u(0);try{const E=await(await m()).recognize(A,{rectangle:S}),R=E.data.text.replace(/\s+/g,"").trim();return n(!1),{text:R,confidence:E.data.confidence}}catch(w){const E=w instanceof Error?w.message:"OCR failed";return c(E),n(!1),null}},[m]),isProcessing:a,error:o,progress:i}}const yr={Red:[229,57,53],Blue:[30,136,229],Green:[67,160,71],Yellow:[253,216,53],Orange:[251,140,0],Purple:[142,36,170],Pink:[216,27,96],White:[245,245,245]};function wr(a,n){let c=0,i=0,u=0,p=0;const m=[];for(let R=0;R<20;R++){const j=n.left+n.width*R/20;m.push([j,n.top+5]),m.push([j,n.top+n.height-5])}for(let R=0;R<20;R++){const j=n.top+n.height*R/20;m.push([n.left+5,j]),m.push([n.left+n.width-5,j])}for(const[R,j]of m){const y=a.getImageData(Math.round(R),Math.round(j),1,1).data;c+=y[0],i+=y[1],u+=y[2],p++}const k=c/p,A=i/p,S=u/p;let w="White",E=1/0;for(const R of Fe){const[j,y,C]=yr[R],x=Math.sqrt(Math.pow(k-j,2)+Math.pow(A-y,2)+Math.pow(S-C,2));x<E&&(E=x,w=R)}return w}function Lr({onScanComplete:a,onClose:n,defaultColour:o}){const c=O.useRef(null),i=O.useRef(null),u=O.useRef(null),p=O.useRef(null),[m,k]=O.useState("idle"),[A,S]=O.useState(null),[w,E]=O.useState(""),[R,j]=O.useState(o),{recognize:y,progress:C}=mr(),x=O.useCallback(async()=>{k("camera-loading"),S(null);try{const g=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}},audio:!1});if(u.current=g,c.current){const L=c.current;L.srcObject=g,await new Promise((M,_)=>{L.onloadedmetadata=()=>{L.play().then(()=>M()).catch(_)},L.onerror=()=>_(new Error("Video failed to load"))}),k("ready")}}catch(g){const L=g instanceof Error?g.message:"Camera access failed";L.includes("Permission denied")||L.includes("NotAllowedError")?S("Camera permission denied. Please allow camera access in your browser settings."):L.includes("NotFoundError")?S("No camera found on this device."):S(`Camera error: ${L}`),k("error")}},[]),N=O.useCallback(()=>{u.current&&(u.current.getTracks().forEach(g=>g.stop()),u.current=null)},[]),T=O.useCallback(async()=>{if(!c.current||!i.current||!p.current)return;k("capturing");const g=c.current,L=i.current,M=L.getContext("2d");if(!M)return;L.width=g.videoWidth,L.height=g.videoHeight,M.drawImage(g,0,0);const _=g.getBoundingClientRect(),Y=p.current.getBoundingClientRect(),Q=Y.left-_.left,z=Y.top-_.top,D=g.videoWidth/g.videoHeight,V=_.width/_.height;let U,J=0,Z=0;D>V?(U=g.videoHeight/_.height,J=(g.videoWidth-_.width*U)/2):(U=g.videoWidth/_.width,Z=(g.videoHeight-_.height*U)/2);const r={left:Math.round(J+Q*U),top:Math.round(Z+z*U),width:Math.round(Y.width*U),height:Math.round(Y.height*U)};k("processing");const e=wr(M,r),t=await y(L,r);t&&t.text?(E(t.text),j(e),k("confirm"),navigator.vibrate&&navigator.vibrate(100)):(S("Could not read ticket number. Try adjusting angle or lighting."),k("ready"))},[y]),P=O.useCallback(()=>{w&&(a(w,R),E(""),k("ready"))},[w,R,a]),W=O.useCallback(()=>{E(""),S(null),k("ready")},[]),K=O.useCallback(()=>{N(),n()},[N,n]);return O.useEffect(()=>(x(),()=>N()),[x,N]),h.jsxs("div",{className:"scanner-modal",children:[h.jsxs("div",{className:"scanner-header",children:[h.jsx("span",{className:"scanner-title",children:"[ TICKET SCANNER ]"}),h.jsx("button",{className:"scanner-close",onClick:K,children:"[X]"})]}),h.jsxs("div",{className:"scanner-content",children:[h.jsxs("div",{className:"camera-container",children:[h.jsx("video",{ref:c,className:"camera-video",playsInline:!0,muted:!0}),h.jsx("canvas",{ref:i,className:"camera-canvas"}),m==="ready"&&h.jsxs("div",{className:"scan-overlay",children:[h.jsxs("div",{className:"scan-region",ref:p,children:[h.jsx("div",{className:"scan-corner top-left"}),h.jsx("div",{className:"scan-corner top-right"}),h.jsx("div",{className:"scan-corner bottom-left"}),h.jsx("div",{className:"scan-corner bottom-right"}),h.jsx("div",{className:"scan-line"})]}),h.jsx("p",{className:"scan-hint",children:"Position ticket number in frame"})]}),m==="camera-loading"&&h.jsx("div",{className:"scanner-overlay-message",children:h.jsx("p",{children:"Starting camera..."})}),m==="processing"&&h.jsxs("div",{className:"scanner-overlay-message",children:[h.jsx("p",{children:"Reading ticket..."}),h.jsx("div",{className:"progress-bar",children:h.jsx("div",{className:"progress-fill",style:{width:`${C}%`}})})]}),m==="error"&&h.jsxs("div",{className:"scanner-overlay-message error",children:[h.jsx("p",{children:A}),h.jsx("button",{className:"scanner-button",onClick:x,children:"[RETRY]"})]})]}),h.jsxs("div",{className:"scanner-controls",children:[m==="ready"&&h.jsxs(h.Fragment,{children:[A&&h.jsx("p",{className:"scanner-error",children:A}),h.jsx("button",{className:"scanner-button capture",onClick:T,children:"[CAPTURE]"})]}),m==="confirm"&&h.jsxs("div",{className:"confirm-panel",children:[h.jsx("input",{type:"text",className:"scanned-number-input",value:w,onChange:g=>E(g.target.value),autoFocus:!0}),h.jsx("div",{className:"colour-picker",children:Fe.map(g=>h.jsx("button",{className:`colour-button ${R===g?"selected":""}`,"data-colour":g.toLowerCase(),onClick:()=>j(g),children:g},g))}),h.jsxs("div",{className:"confirm-actions",children:[h.jsx("button",{className:"scanner-button",onClick:W,children:"[RETRY]"}),h.jsx("button",{className:"scanner-button confirm",onClick:P,children:"[ADD TICKET]"})]})]})]})]})]})}export{Lr as Scanner};
